#!/bin/bash

# Exit on error
set -e

DOTS_DIR="$HOME/dots"
CONFIG_DIR="$DOTS_DIR/.config"

mkdir -p "$CONFIG_DIR/hypr" "$CONFIG_DIR/wlogout/res" "$CONFIG_DIR/waybar" "$CONFIG_DIR/anyrun" "$CONFIG_DIR/nvim" "$CONFIG_DIR/dunst" "$CONFIG_DIR/kitty" "$CONFIG_DIR/mpd" "$CONFIG_DIR/ncmpcpp" "$CONFIG_DIR/mpv" "$DOTS_DIR/.local/bin" "$CONFIG_DIR/wofi" "$CONFIG_DIR/foot" "$CONFIG_DIR/niri" "$DOTS_DIR/.bashrc.d" "$CONFIG_DIR/gtk-3.0" "$CONFIG_DIR/gtk-4.0" "$CONFIG_DIR/ags"

# Copy files
# Hyprland & Hyprlock
cp -f "$HOME/.config/hypr/"*.conf "$CONFIG_DIR/hypr/"

# Wlogout
cp -f "$HOME/.config/wlogout/"{layout,style.css} "$CONFIG_DIR/wlogout/"
cp -rf "$HOME/.config/wlogout/res/"* "$CONFIG_DIR/wlogout/res/"

# Anyrun
cp -rf "$HOME/.config/anyrun/"* "$CONFIG_DIR/anyrun/"
cp -f "$HOME/.config/kidex.ron" "$CONFIG_DIR/kidex.ron"

# Wofi
cp -rf "$HOME/.config/wofi/"* "$CONFIG_DIR/wofi/"

# Foot
cp -rf "$HOME/.config/foot/"* "$CONFIG_DIR/foot/"

# Waybar
cp -rf "$HOME/.config/waybar/"* "$CONFIG_DIR/waybar/"

# Neovim
cp -f "$HOME/.config/nvim/"*.lua "$CONFIG_DIR/nvim/"
cp -rf "$HOME/.config/nvim/lua/"* "$CONFIG_DIR/nvim/lua/"

# Dunst
cp -rf "$HOME/.config/dunst/"* "$CONFIG_DIR/dunst/"

# Kitty
cp -f "$HOME/.config/kitty/kitty.conf" "$CONFIG_DIR/kitty/kitty.conf"

# MPD
cp -f "$HOME/.config/mpd/mpd.conf" "$CONFIG_DIR/mpd/mpd.conf"

# NCMPCPP
cp -f "$HOME/.config/ncmpcpp/config" "$CONFIG_DIR/ncmpcpp/config"
cp -f "$HOME/.config/ncmpcpp/bindings" "$CONFIG_DIR/ncmpcpp/bindings"

# Bashrc
cp -f "$HOME/.bashrc" "$DOTS_DIR/"
cp -rf "$HOME/.bashrc.d/"* "$DOTS_DIR/.bashrc.d/"

# .local/bin
cp -rf "$HOME/.local/bin/"* "$DOTS_DIR/.local/bin/"

# niri
cp -rf "$HOME/.config/niri/"* "$CONFIG_DIR/niri/"

# deps
cp -f "$HOME/deps.md" "$DOTS_DIR/deps.md"

# gtk
cp -rf "$HOME/.config/gtk-3.0/"* "$CONFIG_DIR/gtk-3.0/"
cp -rf "$HOME/.config/gtk-4.0/"* "$CONFIG_DIR/gtk-4.0/"

# ags
cp -rf "$HOME/.config/ags/"* "$CONFIG_DIR/ags/"

# Git stage, commit, and push
git -C "$DOTS_DIR" add .
git -C "$DOTS_DIR" commit -m "Update dotfiles on $(date '+%Y-%m-%d %H:%M')"
git -C "$DOTS_DIR" push


echo "âœ… Dotfiles synced and pushed to GitHub!"
